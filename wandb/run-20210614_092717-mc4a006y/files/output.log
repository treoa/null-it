Validation sanity check: 0it [00:00, ?it/s]Loaded the validation dataloader
Validation sanity check:   0%|                            | 0/2 [00:00<?, ?it/s]I am in the validation step and the shape fo x is torch.Size([64, 14])
I am in the training step and the shapes of logits and y are given respectively torch.Size([64, 2])
 torch.Size([64, 1])
  | Name      | Type             | Params
-----------------------------------------------
0 | l1        | Linear           | 960
1 | l2        | Linear           | 130
2 | do        | Dropout          | 0
3 | out       | Sigmoid          | 0
4 | loss_fn   | CrossEntropyLoss | 0
5 | train_acc | Accuracy         | 0
6 | valid_acc | Accuracy         | 0
-----------------------------------------------
1.1 K     Trainable params
0         Non-trainable params
1.1 K     Total params
0.004     Total estimated model params size (MB)
/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py:69: UserWarning: The dataloader, val dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 12 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  warnings.warn(*args, **kwargs)
Traceback (most recent call last):
  File "classifier.py", line 161, in <module>
    trainer.fit(model, train_loader)
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 458, in fit
    self._run(model)
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 756, in _run
    self.dispatch()
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 797, in dispatch
    self.accelerator.start_training(self)
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 96, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 144, in start_training
    self._results = trainer.run_stage()
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 807, in run_stage
    return self.run_train()
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 842, in run_train
    self.run_sanity_check(self.lightning_module)
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in run_sanity_check
    self.run_evaluation()
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 962, in run_evaluation
    output = self.evaluation_loop.evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/trainer/evaluation_loop.py", line 174, in evaluation_step
    output = self.trainer.accelerator.validation_step(args)
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 226, in validation_step
    return self.training_type_plugin.validation_step(*args)
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in validation_step
    return self.lightning_module.validation_step(*args, **kwargs)
  File "classifier.py", line 140, in validation_step
    loss = self.loss_fn(logits, y.long())
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/torch/nn/modules/loss.py", line 1047, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/torch/nn/functional.py", line 2693, in cross_entropy
    return nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)
  File "/home/treoroygbiv/anaconda3/envs/treo/lib/python3.8/site-packages/torch/nn/functional.py", line 2388, in nll_loss
    ret = torch._C._nn.nll_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index)
RuntimeError: multi-target not supported at /opt/conda/conda-bld/pytorch_1616554793803/work/aten/src/THCUNN/generic/ClassNLLCriterion.cu:15